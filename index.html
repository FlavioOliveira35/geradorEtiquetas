<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Cadastro de Ocorr√™ncia</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: "Segoe UI", sans-serif;
      background-color: #e5ddd5;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
    }
    .form-container {
      background-color: #ffffff;
      max-width: 95%;
      width: 400px;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 2px 2px 5px rgba(0,0,0,0.2);
      border-left: 5px solid #25d366;
    }
    h2 {
      text-align: center;
      font-size: 18px;
      margin-bottom: 15px;
    }
    label {
      font-weight: bold;
      margin-top: 10px;
      display: block;
      font-size: 14px;
    }
    input, select, textarea {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      font-size: 14px;
      border: 1px solid #ccc;
      border-radius: 6px;
      box-sizing: border-box;
    }
    textarea {
      resize: vertical;
    }
    .titulo-alerta {
      text-align: center;
      font-size: 18px;
      font-weight: bold;
      color: red;
      margin-bottom: 15px;
    }
    button {
      margin-top: 20px;
      width: 100%;
      padding: 10px;
      background-color: #25d366;
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      cursor: pointer;
    }
    button:hover {
      background-color: #1ebe5d;
    }
    .final-space {
      height: 20px;
    }
    .prazo-buttons {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }
    .prazo-btn {
      flex: 1;
      padding: 8px;
      border-radius: 6px;
      border: 1px solid #ccc;
      background-color: #f1f1f1;
      cursor: pointer;
      text-align: center;
    }
    .prazo-btn.selected {
      background-color: #25d366;
      color: white;
      border-color: #1ebe5d;
    }
    #justificativa {
      display: none;
    }
  </style>
</head>
<body>
<div class="form-container">
  <div class="titulo-alerta">üö® TESTAR E ENCERRAR üö®</div>

  <label>OCORR√äNCIA:</label>
  <input type="text" id="ocorrencia" required>

  <label>ARD:</label>
  <input type="text" id="ard">

  <label>SP:</label>
  <input type="text" id="sp">

  <label>CAUSA RAIZ:</label>
  <select id="codigo1" onchange="atualizaCodigo2()">
    <option value="">-- Selecione --</option>
    <option value="abalroamento">Abalroamento</option>
    <option value="Furto">Furto</option>
    <option value="Acidente">Acidente</option>
    <option value="Descarga">Descarga</option>
    <option value="Vandalismo">Vandalismo</option>
    <option value="Troca de poste">Troca de poste</option>
    <option value="Degrada√ß√£o/Infiltra√ß√£o">Degrada√ß√£o/Infiltra√ß√£o</option>
    <option value="Defeito Splitter">Defeito Splitter</option>
    <option value="Falha em atividade anterior">Falha em atividade anterior</option>
    <option value="Obras de Terceiros">Obras de Terceiros</option>
  </select>

  <label>CAUSA SECUND√ÅRIA:</label>
  <select id="codigo2">
    <option>-- Selecione Causa Raiz primeiro --</option>
  </select>

  <label>TRATATIVA:</label>
  <input type="text" id="tratativa">

  <label>MATERIAIS UTILIZADOS:</label>
  <textarea id="materiais" rows="2"></textarea>

  <label>ENDERE√áO:</label>
  <input type="text" id="endereco">

  <label>BAIRRO:</label>
  <input type="text" id="bairro">

  <label>CIDADE:</label>
  <input type="text" id="cidade">

  <label>T√âCNICOS:</label>
  <input type="text" id="tecnicos">

  <label>ENTREGA NO PRAZO?</label>
  <div class="prazo-buttons">
    <div class="prazo-btn" onclick="selecionarPrazo(this, 'Dentro do Prazo')">Dentro do Prazo</div>
    <div class="prazo-btn" onclick="selecionarPrazo(this, 'Fora do Prazo')">Fora do Prazo</div>
  </div>
  <input type="hidden" id="prazoSelecionado">

  <label id="labelJustificativa" style="display:none;">Justificativa (se fora do prazo):</label>
  <textarea id="justificativa" rows="2"></textarea>

  <button onclick="copiarTexto()">Copiar para WhatsApp</button>
  <div class="final-space"></div>
</div>

<script>
  function atualizaCodigo2() {
    const codigo1 = document.getElementById("codigo1").value;
    const codigo2 = document.getElementById("codigo2");
    codigo2.innerHTML = "";
    let opcoes = [];
    if (codigo1 === "abalroamento") {
      opcoes = ["", "Ve√≠culo colidiu", "Poste derrubado", "Queda de √°rvore"];
    } else if (codigo1 === "Furto") {
      opcoes = ["", "Cabo", "CEO", "CTO", "Splitter"];
    } else if (codigo1 === "Acidente") {
      opcoes = ["", "Carga Alta"];
    } else if (codigo1 === "Descarga") {
      opcoes = ["", "Atmosf√©rica", "El√©trica"];
    } else if (codigo1 === "Vandalismo") {
      opcoes = ["", "Vandalismo"];
    } else if (codigo1 === "Troca de poste") {
      opcoes = ["", "Troca de poste"];
    } else if (codigo1 === "Degrada√ß√£o/Infiltra√ß√£o") {
      opcoes = ["", "CEO", "CTO", "DGOI"];
    } else if (codigo1 === "Defeito Splitter") {
      opcoes = ["", "Atenuado", "Fibra Curta", "Sa√≠da do Splitter", "Sem sinal"];
    } else if (codigo1 === "Falha em atividade anterior") {
      opcoes = ["", "Atenua√ß√£o", "Desorganiza√ß√£o do", "Fibra Invertida", "Fibra Quebrada"];
    } else if (codigo1 === "Obras de Terceiros") {
      opcoes = ["", "Outras Obras", "Poda de √°rvores", "troca de postes n√£o programada"];
    } else {
      opcoes = ["-- Selecione Causa Raiz primeiro --"];
    }
    opcoes.forEach(opcao => {
      const opt = document.createElement("option");
      opt.text = opcao;
      codigo2.add(opt);
    });
  }

  function selecionarPrazo(btn, valor) {
    document.querySelectorAll('.prazo-btn').forEach(b => b.classList.remove('selected'));
    btn.classList.add('selected');
    document.getElementById("prazoSelecionado").value = valor;
    const justificativa = document.getElementById("justificativa");
    const labelJustificativa = document.getElementById("labelJustificativa");
    if (valor === "Fora do Prazo") {
      justificativa.style.display = "block";
      labelJustificativa.style.display = "block";
    } else {
      justificativa.style.display = "none";
      labelJustificativa.style.display = "none";
      justificativa.value = "";
    }
  }

  function gerarProtocolo() {
    const data = new Date();
    return `PROTOCOLO-${data.getFullYear()}${String(data.getMonth()+1).padStart(2,'0')}${String(data.getDate()).padStart(2,'0')}-${Math.floor(Math.random()*10000)}`;
  }

  function copiarTexto() {
    const getVal = id => document.getElementById(id)?.value || "";

    const protocolo = gerarProtocolo();
    const dataHora = new Date().toLocaleString("pt-BR");

    if (!getVal("ocorrencia")) {
      alert("Por favor, preencha o campo de ocorr√™ncia.");
      return;
    }

    const texto = `üö® TESTAR E ENCERRAR üö®

PROTOCOLO: ${protocolo}
DATA E HORA: ${dataHora}

OCORR√äNCIA: ${getVal("ocorrencia")}
ARD: ${getVal("ard")}
SP: ${getVal("sp")}
CAUSA RAIZ: ${getVal("codigo1")}
CAUSA SECUND√ÅRIA: ${getVal("codigo2")}
TRATATIVA: ${getVal("tratativa")}
MATERIAIS UTILIZADOS: ${getVal("materiais")}
ENDERE√áO: ${getVal("endereco")}
BAIRRO: ${getVal("bairro")}
CIDADE: ${getVal("cidade")}
T√âCNICOS: ${getVal("tecnicos")}
ENTREGA NO PRAZO?: ${getVal("prazoSelecionado")}
Justificativa (se fora do prazo): ${getVal("justificativa")}`;

    navigator.clipboard.writeText(texto).then(() => {
      alert("Texto copiado! Agora cole no WhatsApp.");
    });
  }
</script>
</body>
</html>



